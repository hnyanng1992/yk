<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
  <title>几何数据展示工具</title>
  <link rel="stylesheet" href="https://a.amap.com/jsapi_demos/static/demo-center/css/demo-center.css" />
  <style>
    html, body, #container {
      width: 100%; height: 100%; margin: 0; padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .control-panel {
      position: absolute; top: 20px; left: 20px; width: 420px;
      background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      border-radius: 8px; padding: 0; z-index: 10;
      max-height: 95vh;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }
    .panel-header {
      background: #3388FF; color: white; padding: 15px;
      border-radius: 8px 8px 0 0; margin: 0;
      position: sticky; top: 0; z-index: 11;
      flex-shrink: 0;
    }
    .panel-header h3 { 
      margin: 0; 
      font-size: 18px; 
      text-align: center;
    }
    .panel-content {
      padding: 15px;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .tabs {
      display: flex; 
      border-bottom: 1px solid #eee; 
      margin-bottom: 0;
      background: white; 
      z-index: 10;
      flex-shrink: 0;
    }
    .tab {
      flex: 1; 
      padding: 12px 8px;
      text-align: center; 
      cursor: pointer;
      border-bottom: 3px solid transparent; 
      transition: all 0.3s;
      font-size: 14px;
    }
    .tab.active {
      border-bottom: 3px solid #3388FF; 
      color: #3388FF; 
      font-weight: bold;
    }
    .current-tab-indicator {
      background: #e7f3ff; 
      padding: 10px 12px;
      border-radius: 4px; 
      margin: 0;
      font-size: 13px;
      border-left: 4px solid #3388FF;
      flex-shrink: 0;
    }
    .action-buttons {
      background: white;
      padding: 0 0 10px 0;
      margin: 0;
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .main-button-group {
      display: flex; 
      gap: 8px; 
      margin: 0;
    }
    .main-button-group button {
      flex: 1; 
      padding: 10px; 
      border: none;
      border-radius: 4px; 
      cursor: pointer; 
      font-weight: bold;
      transition: background 0.3s;
      font-size: 13px;
    }
    .btn-primary { background: #3388FF; color: white; }
    .btn-primary:hover { background: #297acc; }
    .btn-secondary { background: #6c757d; color: white; }
    .btn-secondary:hover { background: #5a6268; }
    .btn-success { background: #28a745; color: white; }
    .btn-success:hover { background: #218838; }
    .btn-warning { background: #ffc107; color: #212529; }
    .btn-warning:hover { background: #e0a800; }
    .tab-content {
      display: none;
      flex: 1;
      flex-direction: column;
      gap: 10px;
    }
    .tab-content.active {
      display: flex;
    }
    .format-indicator {
      padding: 8px 12px;
      background: #f8f9fa;
      border-radius: 4px;
      font-size: 12px;
      border-left: 3px solid #28a745;
      flex-shrink: 0;
    }
    .format-indicator.wkt {
      border-left-color: #3388FF;
    }
    .format-indicator.coords {
      border-left-color: #28a745;
    }
    .input-item {
      display: flex;
      flex-direction: column;
      flex: 1;
      min-height: 0;
    }
    .input-item textarea {
      width: 100%; 
      flex: 1;
      min-height: 320px;
      margin: 0; 
      padding: 12px;
      border: 1px solid #ddd; 
      border-radius: 4px; 
      resize: vertical;
      font-family: monospace; 
      font-size: 13px; 
      box-sizing: border-box;
      line-height: 1.5;
    }
    .format-example {
      font-size: 11px; 
      color: #666; 
      margin-top: 6px; 
      font-style: italic;
      flex-shrink: 0;
    }
    .legend {
      padding: 10px; 
      background: #f8f9fa;
      border-radius: 4px; 
      font-size: 11px;
      border-top: 1px solid #eee;
    }
    .legend-item {
      display: flex; 
      align-items: center; 
      margin: 4px 0;
    }
    .legend-color {
      width: 18px; 
      height: 3px; 
      margin-right: 6px;
    }
    .legend-point {
      width: 10px; 
      height: 10px; 
      border-radius: 50%; 
      margin-right: 6px;
    }
    .legend-line { background-color: #3388FF; }
    .legend-polygon { background-color: #FF6B6B; }
    .legend-point-color { background-color: #28a745; }
    
    @media (max-width: 768px) {
      .control-panel { 
        width: calc(100% - 40px); 
        max-height: 85vh; 
      }
      .input-item textarea { 
        min-height: 250px; 
      }
      .panel-content {
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <div id="container"></div>
  <div class="control-panel">
    <div class="panel-header"><h3>几何数据展示工具</h3></div>
    <div class="panel-content">
      <!-- 标签导航 -->
      <div class="tabs">
        <div class="tab active" data-tab="points">点数据</div>
        <div class="tab" data-tab="lines">线数据</div>
        <div class="tab" data-tab="polygons">多边形数据</div>
      </div>
      
      <!-- 当前选中指示器 -->
      <div class="current-tab-indicator" id="current-tab-indicator">当前选中: <strong>点数据</strong></div>
      
      <!-- 操作按钮 - 移到顶部 -->
      <div class="action-buttons">
        <div class="main-button-group">
          <button class="btn-success" id="show-current-btn">显示当前图形</button>
          <button class="btn-primary" id="show-all-btn">显示所有图形</button>
          <button class="btn-secondary" id="clear-all-btn">清除所有</button>
        </div>
      </div>
      
      <!-- 点数据标签页 -->
      <div class="tab-content active" id="points-tab">
        <div class="format-indicator" id="points-format-indicator">检测到格式: <strong>坐标串</strong></div>
        <div class="input-item">
          <textarea id="points-input" placeholder="请输入点数据，支持坐标串格式或WKT格式&#10;坐标串示例: 116.123,39.456;116.124,39.457&#10;WKT示例: MULTIPOINT((116.123 39.456),(116.124 39.457))">116.29642223,39.92031415;116.29628966,39.91976904;116.29609911,39.91929966;116.29603309,39.91915046;116.29583764,39.91876747;116.29581320,39.91873134;116.29570371,39.91856958;116.29545868,39.91814503;116.29514603,39.91752918;116.29501289,39.91723948;116.29494476,39.91699938;116.29489826,39.91671971;116.29488629,39.91630827;116.29488051,39.91574014;116.29490872,39.91308447;116.29490760,39.91291666;116.29487722,39.91027120;116.29487841,39.91016540;116.29487731,39.90937277;116.29487633,39.90788590;116.29488021,39.90774420;116.29487939,39.90754059;116.29487967,39.90741848;116.29488256,39.90724998;116.29487908,39.90665645;116.29488178,39.90584202;116.29491909,39.90387818;116.29492613,39.90247943;116.29488469,39.90024547;116.29491660,39.89835033;116.29491037,39.89741638;116.29491105,39.89724997</textarea>
        </div>
      </div>
      
      <!-- 线数据标签页 -->
      <div class="tab-content" id="lines-tab">
        <div class="format-indicator" id="lines-format-indicator">检测到格式: <strong>坐标串</strong></div>
        <div class="input-item">
          <textarea id="lines-input" placeholder="请输入线数据，支持坐标串格式或WKT格式&#10;坐标串示例: 116.123,39.456;116.124,39.457|116.125,39.458;116.126,39.459&#10;WKT示例: MULTILINESTRING((116.123 39.456,116.124 39.457),(116.125 39.458,116.126 39.459))">116.29642223,39.92031415;116.29628966,39.91976904;116.29609911,39.91929966;116.29603309,39.91915046;116.29583764,39.91876747;116.29581320,39.91873134;116.29570371,39.91856958;116.29545868,39.91814503;116.29514603,39.91752918;116.29501289,39.91723948;116.29494476,39.91699938;116.29489826,39.91671971;116.29488629,39.91630827;116.29488051,39.91574014;116.29490872,39.91308447;116.29490760,39.91291666;116.29487722,39.91027120;116.29487841,39.91016540;116.29487731,39.90937277;116.29487633,39.90788590;116.29488021,39.90774420;116.29487939,39.90754059;116.29487967,39.90741848;116.29488256,39.90724998;116.29487908,39.90665645;116.29488178,39.90584202;116.29491909,39.90387818;116.29492613,39.90247943;116.29488469,39.90024547;116.29491660,39.89835033;116.29491037,39.89741638;116.29491105,39.89724997|116.29507250,39.89724579;116.29508494,39.89823985;116.29507074,39.90002902;116.29507217,39.90025133;116.29507137,39.90104876;116.29507844,39.90156980;116.29509458,39.90247856;116.29509586,39.90387622;116.29508062,39.90620530;116.29507453,39.90713944;116.29507555,39.90725024;116.29507707,39.90741995;116.29508029,39.90754506;116.29510976,39.90774271;116.29510120,39.90897805;116.29510065,39.90934997;116.29509377,39.90965097;116.29507910,39.91005047;116.29507901,39.91016697;116.29507243,39.91277858;116.29507225,39.91291388;116.29506200,39.91510776;116.29506546,39.91550458;116.29505853,39.91616060;116.29506567,39.91638752;116.29508593,39.91660366;116.29511439,39.91677590;116.29513905,39.91692934;116.29518844,39.91711542;116.29522873,39.91729078;116.29530647,39.91750979;116.29580013,39.91838101;116.29588207,39.91848642;116.29593105,39.91854619;116.29602943,39.91870614;116.29622888,39.91909563;116.29627557,39.91919310</textarea>
        </div>
      </div>
      
      <!-- 多边形数据标签页 -->
      <div class="tab-content" id="polygons-tab">
        <div class="format-indicator" id="polygon-format-indicator">检测到格式: <strong>WKT</strong></div>
        <div class="input-item">
          <textarea id="polygon-input" placeholder="请输入多边形数据，支持坐标串格式或WKT格式&#10;坐标串示例: 116.123,39.456;116.124,39.457;116.125,39.458;116.123,39.456&#10;WKT示例: POLYGON((116.123 39.456,116.124 39.457,116.125 39.458,116.123 39.456))">POLYGON((116.417694 39.915705, 116.426632 39.915584, 116.426236 39.924278, 116.417476 39.924379, 116.417694 39.915705))</textarea>
        </div>
      </div>
      
      <!-- 图例 -->
      <div class="legend">
        <div class="legend-item"><div class="legend-point legend-point-color"></div><span>点数据</span></div>
        <div class="legend-item"><div class="legend-color legend-line"></div><span>线数据</span></div>
        <div class="legend-item"><div class="legend-color legend-polygon"></div><span>多边形数据</span></div>
      </div>
    </div>
  </div>

  <script src="https://cache.amap.com/lbs/static/es5.min.js"></script>
  <script src="https://webapi.amap.com/maps?v=2.0&key=1cf9fc45df860df45e87af1230f5da74"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var map = new AMap.Map('container', { zoom: 14, center: [116.422, 39.920], viewMode: '3D' });
      var points = [], lines = [], polygons = [], currentTab = 'points';
      
      // 自动检测格式的函数
      function detectFormat(input, type) {
        if (!input || input.trim() === '') return 'unknown';
        
        var text = input.trim().toUpperCase();
        
        // WKT格式检测
        if (type === 'points') {
          if (text.startsWith('MULTIPOINT') || text.startsWith('POINT')) return 'wkt';
        } else if (type === 'lines') {
          if (text.startsWith('MULTILINESTRING') || text.startsWith('LINESTRING')) return 'wkt';
        } else if (type === 'polygons') {
          if (text.startsWith('MULTIPOLYGON') || text.startsWith('POLYGON')) return 'wkt';
        }
        
        // 坐标串格式检测
        // 检查是否包含分号分隔符（坐标串格式的特征）
        if (input.includes(';')) {
          // 进一步验证坐标格式
          var parts = input.split(';');
          var validCoords = parts.some(part => {
            var coords = part.split(',');
            if (coords.length === 2) {
              var lng = parseFloat(coords[0]), lat = parseFloat(coords[1]);
              return !isNaN(lng) && !isNaN(lat);
            }
            return false;
          });
          if (validCoords) return 'coords';
        }
        
        return 'unknown';
      }
      
      // 更新格式指示器
      function updateFormatIndicator(type) {
        var inputElement, indicatorElement;
        
        if (type === 'points') {
          inputElement = document.getElementById('points-input');
          indicatorElement = document.getElementById('points-format-indicator');
        } else if (type === 'lines') {
          inputElement = document.getElementById('lines-input');
          indicatorElement = document.getElementById('lines-format-indicator');
        } else if (type === 'polygons') {
          inputElement = document.getElementById('polygon-input');
          indicatorElement = document.getElementById('polygon-format-indicator');
        }
        
        if (inputElement && indicatorElement) {
          var format = detectFormat(inputElement.value, type);
          if (format === 'wkt') {
            indicatorElement.innerHTML = '检测到格式: <strong>WKT</strong>';
            indicatorElement.className = 'format-indicator wkt';
          } else if (format === 'coords') {
            indicatorElement.innerHTML = '检测到格式: <strong>坐标串</strong>';
            indicatorElement.className = 'format-indicator coords';
          } else {
            indicatorElement.innerHTML = '格式: <strong>未知</strong>';
            indicatorElement.className = 'format-indicator';
          }
        }
      }
      
      // 标签切换
      document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', function() {
          document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          this.classList.add('active');
          const tabId = this.getAttribute('data-tab');
          document.getElementById(tabId + '-tab').classList.add('active');
          currentTab = tabId;
          updateCurrentTabIndicator();
        });
      });

      // 输入框内容变化时自动检测格式
      document.getElementById('points-input').addEventListener('input', function() {
        updateFormatIndicator('points');
      });
      
      document.getElementById('lines-input').addEventListener('input', function() {
        updateFormatIndicator('lines');
      });
      
      document.getElementById('polygon-input').addEventListener('input', function() {
        updateFormatIndicator('polygons');
      });

      function updateCurrentTabIndicator() {
        const tabNames = { 'points': '点数据', 'lines': '线数据', 'polygons': '多边形数据' };
        document.getElementById('current-tab-indicator').innerHTML = `当前选中: <strong>${tabNames[currentTab]}</strong>`;
      }

      function showCurrent() { 
        clearAll(); 
        if (currentTab === 'points') showPoints(); 
        else if (currentTab === 'lines') showLines(); 
        else if (currentTab === 'polygons') showPolygons(); 
      }

      function showAll() { 
        clearAll(); 
        showPoints(); 
        showLines(); 
        showPolygons(); 
      }

      // 显示点数据 - 使用自动检测的格式
      function showPoints() {
        points.forEach(point => map.remove(point)); points = [];
        var input = document.getElementById('points-input').value.trim();
        var format = detectFormat(input, 'points');
        
        try {
          if (format === 'coords') {
            // 坐标串格式
            var pointStrings = input.split(';');
            pointStrings.forEach(pointStr => {
              var parts = pointStr.split(',');
              if (parts.length >= 2) {
                var lng = parseFloat(parts[0]), lat = parseFloat(parts[1]);
                if (!isNaN(lng) && !isNaN(lat)) {
                  var point = new AMap.Marker({
                    position: [lng, lat],
                    icon: new AMap.Icon({
                      size: new AMap.Size(6, 6),
                      image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNiIgaGVpZ2h0PSI2IiB2aWV3Qm94PSIwIDAgNiA2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxjaXJjbGUgY3g9IjMiIGN5PSIzIiByPSIzIiBmaWxsPSIjMjhhNzQ1Ii8+PC9zdmc+',
                      anchor: 'center'
                    })
                  });
                  map.add(point); points.push(point);
                }
              }
            });
          } else if (format === 'wkt') {
            // WKT格式
            if (input.toUpperCase().startsWith('MULTIPOINT')) {
              var content = input.substring(input.indexOf('(') + 1, input.lastIndexOf(')'));
              var pointStrings = content.split('),(').map(point => {
                point = point.trim();
                if (point.startsWith('(')) point = point.substring(1);
                if (point.endsWith(')')) point = point.substring(0, point.length - 1);
                return point;
              });
              
              pointStrings.forEach(pointContent => {
                var parts = pointContent.split(/\s+/);
                if (parts.length >= 2) {
                  var lng = parseFloat(parts[0]), lat = parseFloat(parts[1]);
                  if (!isNaN(lng) && !isNaN(lat)) {
                    var point = new AMap.Marker({
                      position: [lng, lat],
                      icon: new AMap.Icon({
                        size: new AMap.Size(6, 6),
                        image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNiIgaGVpZ2h0PSI2IiB2aWV3Qm94PSIwIDAgNiA2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxjaXJjbGUgY3g9IjMiIGN5PSIzIiByPSIzIiBmaWxsPSIjMjhhNzQ1Ii8+PC9zdmc+',
                        anchor: 'center'
                      })
                    });
                    map.add(point); points.push(point);
                  }
                }
              });
            } else if (input.toUpperCase().startsWith('POINT')) {
              var content = input.substring(input.indexOf('(') + 1, input.lastIndexOf(')'));
              var parts = content.trim().split(/\s+/);
              if (parts.length >= 2) {
                var lng = parseFloat(parts[0]), lat = parseFloat(parts[1]);
                if (!isNaN(lng) && !isNaN(lat)) {
                  var point = new AMap.Marker({
                    position: [lng, lat],
                    icon: new AMap.Icon({
                      size: new AMap.Size(6, 6),
                      image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNiIgaGVpZ2h0PSI2IiB2aWV3Qm94PSIwIDAgNiA2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxjaXJjbGUgY3g9IjMiIGN5PSIzIiByPSIzIiBmaWxsPSIjMjhhNzQ1Ii8+PC9zdmc+',
                      anchor: 'center'
                    })
                  });
                  map.add(point); points.push(point);
                }
              }
            }
          } else {
            alert('无法识别点数据格式，请检查输入格式');
          }
        } catch (error) { 
          alert('解析错误: ' + error.message); 
        }
      }

      // 显示线数据 - 使用自动检测的格式
      function showLines() {
        lines.forEach(line => map.remove(line)); lines = [];
        var input = document.getElementById('lines-input').value.trim();
        var format = detectFormat(input, 'lines');
        
        try {
          if (format === 'coords') {
            // 坐标串格式 - 使用 | 分隔不同的线
            var lineStrings = input.split('|');
            lineStrings.forEach(lineStr => {
              var coords = [];
              var points = lineStr.split(';');
              points.forEach(point => {
                var parts = point.split(',');
                if (parts.length >= 2) {
                  var lng = parseFloat(parts[0]), lat = parseFloat(parts[1]);
                  if (!isNaN(lng) && !isNaN(lat)) coords.push([lng, lat]);
                }
              });
              if (coords.length > 1) {
                var line = new AMap.Polyline({ path: coords, strokeColor: '#3388FF', strokeWeight: 3, strokeOpacity: 0.8 });
                map.add(line); lines.push(line);
              }
            });
          } else if (format === 'wkt') {
            // WKT格式
            var content = input.substring(input.indexOf('(') + 1, input.lastIndexOf(')'));
            var lineStrings = content.split('),(').map(line => {
              line = line.trim();
              if (line.startsWith('(')) line = line.substring(1);
              if (line.endsWith(')')) line = line.substring(0, line.length - 1);
              return line;
            });
            lineStrings.forEach(lineContent => {
              var coords = []; var points = lineContent.split(',');
              points.forEach(point => {
                point = point.trim(); var parts = point.split(/\s+/);
                if (parts.length >= 2) {
                  var lng = parseFloat(parts[0]), lat = parseFloat(parts[1]);
                  if (!isNaN(lng) && !isNaN(lat)) coords.push([lng, lat]);
                }
              });
              if (coords.length > 1) {
                var line = new AMap.Polyline({ path: coords, strokeColor: '#3388FF', strokeWeight: 3, strokeOpacity: 0.8 });
                map.add(line); lines.push(line);
              }
            });
          } else {
            alert('无法识别线数据格式，请检查输入格式');
          }
        } catch (error) { 
          alert('解析错误: ' + error.message); 
        }
      }

      // 显示多边形数据 - 使用自动检测的格式
      function showPolygons() {
        polygons.forEach(polygon => map.remove(polygon)); polygons = [];
        var input = document.getElementById('polygon-input').value.trim();
        var format = detectFormat(input, 'polygons');
        
        try {
          if (format === 'coords') {
            // 坐标串格式
            var points = input.split(';'), coords = [];
            points.forEach(point => {
              var parts = point.split(',');
              if (parts.length >= 2) {
                var lng = parseFloat(parts[0]), lat = parseFloat(parts[1]);
                if (!isNaN(lng) && !isNaN(lat)) coords.push([lng, lat]);
              }
            });
            if (coords.length >= 3) {
              var polygon = new AMap.Polygon({
                path: coords, strokeColor: '#FF6B6B', strokeWeight: 2, strokeOpacity: 0.8,
                fillColor: '#FF6B6B', fillOpacity: 0.3
              });
              map.add(polygon); polygons.push(polygon);
              map.setFitView([polygon]);
            }
          } else if (format === 'wkt') {
            // WKT格式
            if (input.toUpperCase().startsWith('POLYGON')) {
              var content = input.substring(input.indexOf('((') + 2, input.lastIndexOf('))'));
              var rings = content.split('),(');
              
              rings.forEach(ringContent => {
                var coords = [];
                var points = ringContent.split(',');
                
                points.forEach(point => {
                  point = point.trim();
                  var parts = point.split(/\s+/);
                  if (parts.length >= 2) {
                    var lng = parseFloat(parts[0]), lat = parseFloat(parts[1]);
                    if (!isNaN(lng) && !isNaN(lat)) {
                      coords.push([lng, lat]);
                    }
                  }
                });
                
                // 确保多边形闭合
                if (coords.length > 0 && (coords[0][0] !== coords[coords.length-1][0] || coords[0][1] !== coords[coords.length-1][1])) {
                  coords.push([coords[0][0], coords[0][1]]);
                }
                
                if (coords.length >= 3) {
                  var polygon = new AMap.Polygon({
                    path: coords, 
                    strokeColor: '#FF6B6B', 
                    strokeWeight: 2, 
                    strokeOpacity: 0.8,
                    fillColor: '#FF6B6B', 
                    fillOpacity: 0.3
                  });
                  map.add(polygon); 
                  polygons.push(polygon);
                  map.setFitView([polygon]);
                }
              });
            } else if (input.toUpperCase().startsWith('MULTIPOLYGON')) {
              var multiContent = input.substring(input.indexOf('((') + 2, input.lastIndexOf('))'));
              var polygonsContent = multiContent.split(')),((');
              
              polygonsContent.forEach(polyContent => {
                var rings = polyContent.split('),(');
                
                rings.forEach(ringContent => {
                  var coords = [];
                  var points = ringContent.split(',');
                  points.forEach(point => {
                    var parts = point.trim().split(/\s+/);
                    if (parts.length >= 2) {
                      var lng = parseFloat(parts[0]), lat = parseFloat(parts[1]);
                      if (!isNaN(lng) && !isNaN(lat)) coords.push([lng, lat]);
                    }
                  });
                  
                  if (coords.length >= 3) {
                    var polygon = new AMap.Polygon({
                      path: coords, strokeColor: '#FF6B6B', strokeWeight: 2, strokeOpacity: 0.8,
                      fillColor: '#FF6B6B', fillOpacity: 0.3
                    });
                    map.add(polygon); polygons.push(polygon);
                    map.setFitView([polygon]);
                  }
                });
              });
            }
          } else {
            alert('无法识别多边形数据格式，请检查输入格式');
          }
        } catch (error) { 
          console.error('解析错误:', error);
          alert('解析错误: ' + error.message); 
        }
      }

      function clearAll() {
        points.forEach(point => map.remove(point)); points = [];
        lines.forEach(line => map.remove(line)); lines = [];
        polygons.forEach(polygon => map.remove(polygon)); polygons = [];
      }

      // 事件监听
      document.getElementById('show-current-btn').addEventListener('click', showCurrent);
      document.getElementById('show-all-btn').addEventListener('click', showAll);
      document.getElementById('clear-all-btn').addEventListener('click', clearAll);

      // 初始化
      setTimeout(function() { 
        updateCurrentTabIndicator();
        // 初始化格式检测
        updateFormatIndicator('points');
        updateFormatIndicator('lines');
        updateFormatIndicator('polygons');
        // 默认显示所有图形
        showAll();
      }, 500);
    });
  </script>
</body>
</html>
